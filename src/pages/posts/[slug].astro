---
import { CollectionEntry, getCollection } from "astro:content";
import createSlug from "../../lib/createSlug";
import ContentLayout from "../../Layouts/ContentLayout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog", (blog) => !blog.data.draft);

  return posts.map((post) => ({
    params: { slug: createSlug(post.data.title) },
    props: { post },
  }));
}

export interface prop {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;

const { data, render } = post;

const { Content } = await render();
---

<ContentLayout>
  <section>
    <h1 class="my-2 p-0">{data.title}</h1>
    <div class="text-md space-x-2 italic">
      <span>{data.publishDate}</span>
      <span>{data.author}</span>
    </div>
    <div class="space-x-2">
      {
        data.tags.map((tag: string) => (
          <a
            href={`/tags/${createSlug(tag)}`}
            class="hover:underline no-underline underline-offset-4 decoration-teal-200 decoration-dashed hover:cursor-pointer text-teal-200"
          >
            #{tag}
          </a>
        ))
      }
    </div>
    <p>{data.description}</p>
  </section>
  <Content />
</ContentLayout>
